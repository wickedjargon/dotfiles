#!/bin/bash

# Control MPD volume and update xob
# Usage: xob-mpd [up|down]

PIPE="/tmp/xobpipe"

# Ensure pipe exists
if [ ! -p "$PIPE" ]; then
    exit 1
fi

case "$1" in
    up)
        mpc volume +5 > /dev/null
        ;;
    down)
        mpc volume -5 > /dev/null
        ;;
esac

# Update polybar (keep existing functionality)
polybar-msg action "#mpd.hook.0" > /dev/null 2>&1

# Get volume percentage
# mpc volume output format: "volume: 50%"
vol=$(mpc volume | grep -o '[0-9]\+%' | tr -d '%')

# Write to pipe
timeout 0.2s bash -c "echo \"$vol\" > $PIPE"
